<!DOCTYPE html>
<html>
<p id="debug"></p>

<!-- Vertex Shader -->
<script id="vertex-shader" type="x-shader/x-vertex">#version 300 es
    in vec4 vPosition; 
    in vec3 a_normal;

    uniform vec3 u_lightWorldPosition;
    uniform vec3 u_viewWorldPosition;

    uniform mat4 MVP; // Resource calls it u_worldViewProjection
    uniform mat4 u_world;
    uniform mat4 u_worldInverseTranspose;

    out vec3 v_surfaceToLight;
    out vec3 v_normal;
    out vec3 v_surfaceToView;

    void main() {
        
            gl_Position =  MVP * vPosition;

            v_normal = mat3(u_worldInverseTranspose) * a_normal;

            vec3 surfaceWorldPosition = (u_world * vPosition).xyz;

            v_surfaceToLight = u_lightWorldPosition - surfaceWorldPosition;

            v_surfaceToView = u_viewWorldPosition - surfaceWorldPosition;
    }
</script>


<!-- Fragment Shader -->
<script id="fragment-shader" type="x-shader/x-fragment">#version 300 es
    precision highp float;
    in vec3 v_normal;
    in vec3 v_surfaceToLight;
    in vec3 v_surfaceToView;
    

    uniform vec4 vColor;
    uniform float u_shininess;
    uniform vec3 u_lightDirection;
    uniform float u_limit;
    uniform vec3 u_lightColor;
    uniform vec3 u_specularColor;
    
    out vec4 outColor;

    void main() {
        vec3 normal = normalize(v_normal);
        vec3 surfaceToLightDirection = normalize(v_surfaceToLight);
        vec3 surfaceToViewDirection = normalize(v_surfaceToView);
        vec3 halfVector = normalize(surfaceToLightDirection + surfaceToViewDirection);
        // I BELIEVE THIS CODE IS FOR THE SPOTLIGHT WHICH LOOKS UGLY TO ME
        // I THINK I USED SPOTLIGHT CALCULATIONS ON THE POINTLIGHT THATS WHY IT LOOKED SO UGLY


        // float light = 0.0;
        // float specular = 0.0;
        // float dotFromDirection = dot(surfaceToLightDirection, -u_lightDirection);
        //  if (dotFromDirection >= u_limit) {
        //    light = dot(normal, surfaceToLightDirection);
        //    if (light > 0.0) {
        //        specular = pow(dot(normal, halfVector), u_shininess);
        //    }
        //}


        // THIS CODE IS FOR THE POINTLIGHT 
        float light = dot(normal, surfaceToLightDirection);
        float specular = 0.0;
        if (light > 0.0) {
            specular = pow(dot(normal, halfVector), u_shininess);
        }

        outColor = vColor;
        outColor.rgb *= light;
        outColor.rgb += specular;

        // If i want the light to have color, comment out the above and uncomment the bottom
        // outColor.rgb *= light * u_lightColor;
        // outColor.rgb += specular * u_specularColor;
    }
</script>



<script type="text/javascript" src="Common/webgl-utils.js"></script>
<script type="text/javascript" src="Common/initShaders.js"></script>
<script type="text/javascript" src="Common/MV.js"></script>
<script type="text/javascript" src="cow.js"></script>
<script type="text/javascript" src="shadingCow.js"></script>

<!-- <link rel="stylesheet" href="style.css"> -->


<body>
<canvas id="gl-canvas" width="512" height="512"> 
Oops ... your browser doesn't support the HTML5 canvas element
</canvas>
</body>
</html>
